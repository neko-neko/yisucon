## 概要
ISUCONの詳細を記載します。

## 参加事項
1チームは1-3人とします。
リモートでの助っ人は一応認めておりますが、グローバルに公開されてるインスタンスなので常識の範囲内でお願いします。

## チューニング可能な時間について
12/8 13:00 ~ 12/9 13:00 となります。
なお、12/9 11:00~ で他チームのスコアを見えなくする予定です。（そっちのほうがドキドキ感あるので）

## 運営のサポートについて
松山までお問い合わせください。
基本的な質問やトラブルなどにはできる限り対応いたしますが、
スコアに影響するような質問にはお答えできませんのでご了承ください。

## アプリケーションサーバ構成
### OS
CentOS 7.2

### アプリケーション
参考実装としてRuby, Node.js, Go, PHP, Java のWebアプリケーションが用意されています。
ただし各々の初期性能は一致していません。どれをベースに用いても構いません。独自で実装してもOKです。

### Nginx
WebサーバとしてデフォルトでNginxが起動しており、systemdで管理されています。
こちらももちろん変えていただいて構いません。

### MariaDB
ポート3306で MariaDB が起動しています。

ユーザ名: `root`
パスワード: なし

## アプリケーション起動
初期設定ではNode実装のアプリケーションが動いています。
ブラウザから80番ポートにアクセスして動作確認しましょう。

## 言語の切り替え
参考実装実装として、Node.js, Ruby, Go, PHP, Javaが用意されています。

各言語実装は systemd で管理されています。基本的には `systemctl stop/start` ならびに `systemctl enable/disable` で制御します。

### PHPの場合
systemd での切り替えのほか、nginxの設定変更が必要です。`/etc/nginx/php-fpm.conf` が置いてあるのでそれを使用してください。

## ベンチマーク実行
ポータルサイトから実行できます。
チームごとログインし、アプリケーションサーバの設定とベンチマーク実行を行ってください。

## ルール詳細
指定されたサーバー上のアプリケーションのチューニングをおこない、それに対するベンチマークのスコアで競技をおこないます。
そのサーバー1台のみでアプリケーションの動作が可能であればどのような変更を加えても構いません。

計測ツールとブラウザの挙動に差異がある場合、計測ツールの挙動を正とします。
また初期実装毎に若干の挙動の違いはありますが、計測ツールに影響のない挙動に関しては問題ないもの（仕様）として扱います。

なお、以下の機能は変更してはいけません。
- URI（ポート, HTTPリクエストパス）
- レスポンスのDOM構造
- JavaScript/CSSファイルの内容

### スコアについて
基本スコアは以下のルールで算出されます。
```
成功レスポンス数(GET) x 1 + 成功レスポンス数(POST) x 2 - (サーバエラー(error)レスポンス数 x 10 + リクエスト失敗(exception)数 x 20 + 遅延POSTレスポンス数 x 100)
```
ただし、基本スコアと計測ツールの出すスコアが異なっている場合は、計測ツールの出すスコアが優先されます。

### 減点対象
以下の事項に抵触すると減点対象となります。

- 存在するべきDOM要素がレスポンスHTMLに存在しない
- リクエスト失敗（通信エラー等）が発生する
- サーバエラー(Status 5xx)・クライアントエラー(Status 4xx)
- 他、計測ツールが検出したケース

### 注意事項
- リダイレクトはリダイレクト先が正しいレスポンスを返せた場合に、1回レスポンスが成功したと判断します
- POSTの失敗は大幅な減点対象です

### 制約事項
以下の事項に抵触すると点数が無効となります。
- GET /initialize へのレスポンスが10秒以内に終わらない
- JavaScript/CSSファイルがアクセスできない
